# Discovery Plugins Configuration
# This file defines which cloud resources can be discovered and how

discovery_settings:
  cache:
    enabled: true
    ttl: 3600 # 1 hour
    max_size: 10000
  concurrency:
    max_workers: 10
    max_regions: 5
  timeouts:
    api_timeout: 30
    discovery_timeout: 300
  default_filters:
    include_tags:
      Environment: [ "prod", "staging", "dev" ]
    exclude_tags:
      Temporary: "true"
    resource_types: [] # Empty means all types
    age_threshold: 86400 # 24 hours
    cost_threshold: 100.0
    security_score: 7
  quality_thresholds:
    completeness: 0.85
    accuracy: 0.90
    freshness: 3600
  notifications:
    enabled: true
    webhook_url: ""
    email: ""

aws:
  # Core Compute Services
  ec2_instances:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_stopped: "true"
      include_spot: "true"

  vpc_networks:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_default: "true"

  subnets:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_private: "true"
      include_public: "true"

  security_groups:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_default: "true"

  internet_gateways:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config: {}

  nat_gateways:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config: {}

  load_balancers:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_alb: "true"
      include_nlb: "true"
      include_clb: "true"

  # Database Services
  rds_instances:
    enabled: true
    priority: 1
    dependencies: [ "vpc_networks" ]
    config:
      include_multi_az: "true"

  dynamodb_tables:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_global_tables: "true"

  elasticache_clusters:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_redis: "true"
      include_memcached: "true"

  # Storage Services
  s3_buckets:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_versioning: "true"
      include_encryption: "true"

  # Container & Orchestration
  ecs_clusters:
    enabled: true
    priority: 1
    dependencies: [ "vpc_networks" ]
    config:
      include_fargate: "true"
      include_ec2: "true"

  eks_clusters:
    enabled: true
    priority: 1
    dependencies: [ "vpc_networks" ]
    config:
      include_node_groups: "true"

  # Serverless & Functions
  lambda_functions:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_layers: "true"

  # Messaging & Integration
  sqs_queues:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_dlq: "true"

  sns_topics:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_subscriptions: "true"

  # Security & Identity
  iam_roles:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_service_roles: "true"
      include_user_roles: "true"

  secrets_manager:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_rotation: "true"

  kms_keys:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_aliases: "true"

  # Monitoring & Logging
  cloudwatch_logs:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_metrics: "true"

  cloudtrail_trails:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_global: "true"

  # Networking & Content Delivery
  cloudfront_distributions:
    enabled: true
    priority: 2
    dependencies: [ "s3_buckets" ]
    config:
      include_origins: "true"

  route53_zones:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_records: "true"

  # API & Gateway
  api_gateway:
    enabled: true
    priority: 2
    dependencies: [ "lambda_functions" ]
    config:
      include_stages: "true"

  # Development & CI/CD
  codebuild_projects:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_build_history: "true"

  codepipeline_pipelines:
    enabled: true
    priority: 3
    dependencies: [ "codebuild_projects" ]
    config:
      include_executions: "true"

  codedeploy_applications:
    enabled: true
    priority: 3
    dependencies: [ "ec2_instances" ]
    config:
      include_deployments: "true"

  # Compute & Batch Processing
  batch_job_queues:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_job_definitions: "true"

  fargate_task_definitions:
    enabled: true
    priority: 3
    dependencies: [ "ecs_clusters" ]
    config:
      include_services: "true"

  emr_clusters:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_steps: "true"

  # Database & Analytics
  neptune_clusters:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_instances: "true"

  documentdb_clusters:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_instances: "true"

  msk_clusters:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_brokers: "true"

  mq_brokers:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_instances: "true"

  # Networking & Transfer
  transfer_servers:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_users: "true"

  direct_connect_connections:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_gateways: "true"

  vpn_connections:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_customer_gateways: "true"

  transit_gateways:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_attachments: "true"

  # Observability & Monitoring
  app_mesh_meshes:
    enabled: true
    priority: 3
    dependencies: [ "ecs_clusters", "eks_clusters" ]
    config:
      include_services: "true"

  xray_groups:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_traces: "true"

  # Development Tools
  cloud9_environments:
    enabled: true
    priority: 3
    dependencies: [ "vpc_networks" ]
    config:
      include_instances: "true"

  codestar_projects:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_resources: "true"

  amplify_apps:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_branches: "true"

  # Additional AWS services - Analytics & Data Processing
  athena_workgroups:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_query_history: "true"

  kinesis_streams:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_enhanced_monitoring: "true"

  datapipeline_pipelines:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_schedules: "true"

  quicksight_dashboards:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_analyses: "true"

  datasync_tasks:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_agents: "true"

  storagegateway_gateways:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_volumes: "true"

  backup_vaults:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_plans: "true"

  fsx_file_systems:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_backups: "true"

  workspaces_workspaces:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_bundles: "true"

  appstream_fleets:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_images: "true"

  # Security Services
  waf_web_acls:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_rules: "true"

  shield_protections:
    enabled: true
    priority: 2
    dependencies: []
    config: {}

  config_rules:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_compliance: "true"

  guardduty_detectors:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_findings: "true"

  # Management & Governance
  cloudformation_stacks:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_resources: "true"

  systems_manager_parameters:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_automation: "true"

  step_functions:
    enabled: true
    priority: 2
    dependencies: [ "lambda_functions" ]
    config:
      include_executions: "true"

  # Auto Scaling
  autoscaling_groups:
    enabled: true
    priority: 2
    dependencies: [ "ec2_instances" ]
    config:
      include_policies: "true"

azure:
  # Core Compute Services
  virtual_machines:
    enabled: true
    priority: 1
    dependencies: [ "virtual_networks" ]
    config:
      include_stopped: "true"

  virtual_networks:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_subnets: "true"

  # Storage Services
  storage_accounts:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_blob: "true"
      include_file: "true"

  # Database Services
  sql_databases:
    enabled: true
    priority: 1
    dependencies: [ "virtual_networks" ]
    config:
      include_elastic_pools: "true"

  # Web & App Services
  web_apps:
    enabled: true
    priority: 1
    dependencies: [ "virtual_networks" ]
    config:
      include_slots: "true"

  function_apps:
    enabled: true
    priority: 1
    dependencies: [ "virtual_networks" ]
    config:
      include_functions: "true"

  # Container & Orchestration
  container_instances:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_groups: "true"

  container_registries:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_repositories: "true"

  aks_clusters:
    enabled: true
    priority: 1
    dependencies: [ "virtual_networks" ]
    config:
      include_node_pools: "true"

  service_fabric_clusters:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_applications: "true"

  spring_cloud_services:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_apps: "true"

  # API & Integration
  api_management:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_apis: "true"

  event_grid_topics:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_subscriptions: "true"

  stream_analytics_jobs:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_inputs: "true"

  # Data & Analytics
  data_lake_storage:
    enabled: true
    priority: 2
    dependencies: [ "storage_accounts" ]
    config:
      include_filesystems: "true"

  hdinsight_clusters:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_components: "true"

  databricks_workspaces:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_clusters: "true"

  machine_learning_workspaces:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_computes: "true"

  # AI & Cognitive Services
  cognitive_services:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_accounts: "true"

  bot_services:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_channels: "true"

  # Communication & Media
  signalr_services:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_hubs: "true"

  media_services:
    enabled: true
    priority: 2
    dependencies: [ "storage_accounts" ]
    config:
      include_accounts: "true"

  video_indexer:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_accounts: "true"

  # IoT & Edge
  maps_accounts:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_keys: "true"

  time_series_insights:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_environments: "true"

  digital_twins:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_instances: "true"

  # Messaging & Integration
  logic_apps:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_workflows: "true"

  event_hubs:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_namespaces: "true"

  service_bus:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_namespaces: "true"

  # Database Services
  cosmos_db:
    enabled: true
    priority: 1
    dependencies: [ "virtual_networks" ]
    config:
      include_databases: "true"

  # Data & Analytics
  data_factory:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_factories: "true"

  synapse_analytics:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_workspaces: "true"

  # Monitoring & Observability
  application_insights:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_components: "true"

  # Security & Governance
  policy_assignments:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_definitions: "true"

  # Networking
  load_balancers:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_backend_pools: "true"

  # Security
  key_vaults:
    enabled: true
    priority: 1
    dependencies: [ "virtual_networks" ]
    config:
      include_secrets: "true"

  # Management
  resource_groups:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_resources: "true"

  # Networking
  bastion_hosts:
    enabled: true
    priority: 2
    dependencies: [ "virtual_networks" ]
    config:
      include_connections: "true"

  # Additional Azure services - Analytics & Data Processing
  dataexplorer_clusters:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_databases: "true"

  datashare_accounts:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_shares: "true"

  purview_accounts:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_catalogs: "true"

  datafactory_v2_instances:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_pipelines: "true"

  streamanalytics_jobs:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_inputs: "true"

  datalakeanalytics_accounts:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_jobs: "true"

  datalakestore_accounts:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_firewall_rules: "true"

  datacatalog_instances:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_assets: "true"

  databox_orders:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_jobs: "true"

gcp:
  # Core Compute Services
  compute_instances:
    enabled: true
    priority: 1
    dependencies: [ "vpc_networks" ]
    config:
      include_stopped: "true"

  vpc_networks:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_subnets: "true"

  # Storage Services
  storage_buckets:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_objects: "true"

  # Container & Orchestration
  gke_clusters:
    enabled: true
    priority: 1
    dependencies: [ "vpc_networks" ]
    config:
      include_node_pools: "true"

  # Database Services
  cloud_sql:
    enabled: true
    priority: 1
    dependencies: [ "vpc_networks" ]
    config:
      include_instances: "true"

  # Serverless & Functions
  cloud_functions:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_triggers: "true"

  cloud_run:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_services: "true"

  # Development & CI/CD
  cloud_build:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_triggers: "true"

  # Messaging & Integration
  cloud_pubsub:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_topics: "true"

  # Data & Analytics
  bigquery:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_datasets: "true"

  cloud_spanner:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_instances: "true"

  cloud_firestore:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_collections: "true"

  # Security
  cloud_armor:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_policies: "true"

  # Monitoring & Observability
  cloud_monitoring:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_metrics: "true"

  cloud_logging:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_logs: "true"

  # Task & Scheduling
  cloud_tasks:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_queues: "true"

  cloud_scheduler:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_jobs: "true"

  # Networking
  cloud_dns:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_zones: "true"

  cloud_cdn:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_backends: "true"

  cloud_load_balancing:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_url_maps: "true"

  cloud_nat:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_gateways: "true"

  cloud_router:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_routers: "true"

  cloud_vpn:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_gateways: "true"

  cloud_interconnect:
    enabled: true
    priority: 2
    dependencies: [ "vpc_networks" ]
    config:
      include_attachments: "true"

  # Security & IAM
  cloud_kms:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_keyrings: "true"

  cloud_iam:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_service_accounts: "true"

  cloud_resource_manager:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_projects: "true"

  cloud_billing:
    enabled: true
    priority: 1
    dependencies: []
    config:
      include_accounts: "true"

  # Observability & Monitoring
  cloud_trace:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_traces: "true"

  cloud_debugger:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_targets: "true"

  cloud_profiler:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_profiles: "true"

  cloud_error_reporting:
    enabled: true
    priority: 2
    dependencies: []
    config:
      include_services: "true"

  # Additional GCP services - Analytics & Data Processing
  dataflow_jobs:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_templates: "true"

  dataproc_clusters:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_jobs: "true"

  composer_environments:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_dags: "true"

  data_catalog_entries:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_tags: "true"

  data_fusion_instances:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_pipelines: "true"

  data_labeling_datasets:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_annotations: "true"

  automl_models:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_versions: "true"

  vertex_ai_models:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_endpoints: "true"

  cloudbuild_triggers:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_builds: "true"

  clouddeploy_pipelines:
    enabled: true
    priority: 3
    dependencies: []
    config:
      include_releases: "true"
